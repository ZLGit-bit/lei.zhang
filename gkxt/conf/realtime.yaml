spark:
   es_sql: "
      select distinct  
        md5(concat(pass.person_id,pass.dev_time)) id,
        kp.name,
        kp.idcard,
        pass.person_id person_id,
        pass.dev_time dev_time,
        pass.dev_id dev_id,
        rc.dev_name,
        '%s' dev_type,
        '' pic_path,
        concat(rc.e_wd,',',rc.e_jd) location,
        from_unixtime(unix_timestamp(),'yyyy-MM-dd HH:mm:ss') create_date,
        kp.pid pid,
        kp.person_type key_person,
        df.flag dev_flag,
        case when df.flag is null then '0' else '1' end as high_light,
        kp.key_level person_level
        from %s pass
        inner join key_person_id kp
        on pass.person_id=kp.%s
        inner join dw_device_real rc
        on pass.dev_id=rc.dev_code
        left join rel_device_flag df
        on rc.dev_code=df.code"
 
   last_place_sql: "
        select 
        id,
        person_id  entity_id,
        dev_type entity_type,
        pid person_id,
        idcard idcard,
        name person_name,
        key_person person_type,
        dev_id road_code,
        dev_name name,
        concat(substr(location,instr(location,',')+1),'/',substr(location,0,instr(location,',')-1)) location,
        '0' alarm,
        dev_time pass_date,
        from_unixtime(unix_timestamp(),'yyyy-MM-dd HH:mm:ss') create_date,
        '0' direction,
        B.top_close top_close,
        '0' status,
        substr(location,instr(location,',')+1) e_jd,
        substr(location,0,instr(location,',')-1) e_wd,
        person_level key_level,
        '' pic_path,
        '' face_alarmpath,
        '' face_bigurl,
        '' face_path,
        '' face_similar
        from 
        (select *,row_number() over(distribute by person_id sort by dev_time desc) rank from rs_tb) A
        left join dev_distince3 B
        on A.dev_id=B.code
        where rank=1"

mysql:
   user: root
   password: bfd123456
   url: jdbc:mysql://10.236.54.237:3306/bs_list?characterEncoding=UTF-8&useSSL=False
   bs_list_url: mysql+mysqldb://root:bfd123456@10.236.54.237:3306/bs_list?charset=utf8
   regist_tb: dw_device_real,key_person_id,rel_device_flag,dev_distince3 
   last_tb: dw_key_person_area_alarm
   entity_now_tb: dw_entity_now
   key_person_id_sql: "
        select distinct a.idcard,a.name,a.key_level,a.id pid,c.imsi,c.mac,d.platenum,b.person_type 
        from key_person a
        inner join rel_key_person_type b
        on a.id=b.person_id 
        left join key_person_phone c
        on a.idcard=c.idcard
        left join key_person_car d
        on a.idcard=d.idcard "
   del_last_place_sql: "
        delete from dw_key_person_area_alarm
        where entity_type ='%s' and entity_id in(select entity_id from %s);"
   last_place_sql: "
        select distinct 
        A.entity_id,A.entity_type,A.person_id,A.idcard,A.person_name,A.person_type,A.road_code,A.name,A.location,A.alarm,A.pass_date,A.create_date,A.direction,A.top_close,A.status,A.e_jd,A.e_wd,A.key_level
        from %s A
        left join dw_key_person_area_alarm B
        on  A.entity_id=B.entity_id and A.entity_type=B.entity_type
        where B.entity_id is null and A.entity_type='%s'  and A.e_jd!='\\N' and A.person_id is not null and A.pass_date<DATE_SUB(CURDATE(),INTERVAL -1 day) 
        group by A.person_id;"         
   
redis:
   host: 10.236.54.235
   port: 6379
   pass: redis2017
